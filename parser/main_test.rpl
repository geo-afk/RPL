ROLE Manager {
    PERMISSIONS: [
        {
            ACTIONS: [ READ, WRITE ],
            RESOURCES: [ Report ]
        }
    ]
}



GROUP Engineering {
    members: [ alice ]
}

resource UserDatabase {
    path: "/databases/users",
    type: database,
    metadata: {
        engine: "PostgreSQL",
        region: "us-east-1",
        encrypted: true,
        backupEnabled: true
    }
}

ROLE Reader extends Manager{
    CAN: [ READ ] RESOURCES: [ File.log ]
}

ROLE SuperUser {
    CAN: [ * ] RESOURCES: [ System.* ]
}

resource PaymentAPI {
    path: "/api/v1/payments",
    type: api,
    metadata: {
        version: "1.0",
        environment: "production"
    }
}

GROUP QA {
    MEMBERS: [ Jordan, Alice ],
    ROLE: [ Tester ]
}

ROLE MobileUser {
    PERMISSIONS: [
        {
            ACTIONS: [ READ ],
            RESOURCES: [ App.data ]
        }
    ]
}

ROLE DataOps {
    PERMISSIONS: [
        {
            ACTIONS: [ MODIFY ],
            RESOURCES: [ one ],
            CONDITIONS: db.size > 100
        }
    ]
}

ROLE Analyst {
    PERMISSIONS: [
        {
            ACTIONS: [ READ ],
            RESOURCES: [ Finance.records ],
            CONDITIONS: person.level >= 3
        }
    ]
}

ROLE Reviewer {
    PERMISSIONS: [
        {
            ACTIONS: [ READ ],
            RESOURCES: [ Document ],
            CONDITIONS: person.department IN [ "qa", "qc" ]
        }
    ]
}

ROLE Ops {
    PERMISSIONS: [
        {
            ACTIONS: [ START, STOP ],
            RESOURCES: [ Server ],
            CONDITIONS: NOT user1 == user1
        }
    ]
}

ROLE Metrics {
    PERMISSIONS: [
        {
            ACTIONS: [ READ ],
            RESOURCES: [ Metrics.cpu ],
            CONDITIONS: (load + 10) > 50
        }
    ]
}

ROLE CloudUser {
    CAN: [ DEPLOY ] RESOURCES: [ Cloud.service ]
}

USER DevA {
    ROLE: [ Developer ],
    VALID_FROM: "2020-01-01",
    VALID_UNTIL: "2030-01-01"
}

resource DocumentsFolder {
    path: "/shared/documents",
    type: folder,
    metadata: {
        owner: "admin",
        size: "10GB",
        created: "2024-01-15"
    }
}

GROUP DataTeam {
    MEMBERS: [ Bob, Lisa ]
}

ROLE UploadUser {
    PERMISSIONS: [
        {
            ACTIONS: [ WRITE, READ ],
            RESOURCES: [ Bucket.files ],
            CONDITIONS: filename CONTAINS ".csv"
        }
    ]
}

ROLE Expression {
    PERMISSIONS: [
        {
            ACTIONS: [ READ ],
            RESOURCES: [ Calc ],
            CONDITIONS: (5 + 3 * 2) > 10
        }
    ]
}

USER Guest {
    ROLE: [ Viewer ]
}

resource TempStorage {
    path: "/tmp/storage",
    type: folder,
    metadata: {}
}


ROLE FileAdmin {
    PERMISSIONS: [
        {
            ACTIONS: [ DELETE ],
            RESOURCES: [ File.backup ]
        }
    ]
}

ROLE hrStaff {
    PERMISSIONS: [
        {
            ACTIONS: [ READ, WRITE ],
            RESOURCES: [ Employee.data ],
            CONDITIONS: employee.status CONTAINS "active"
        }
    ]
}

resource AnalyticsAPI {
    path: "/api/analytics",
    type: api,
    metadata: {
        version: "2.1.5",
        deprecated: false,
        maxConnections: 500,
        supportedFormats: ["json", "xml", "csv"],
        maintainer: "data-team",
        documentation: "https://docs.example.com/analytics"
    }
}

USER SystemBot {
    ROLE: [ Automation ]
}

ROLE Audit {
    PERMISSIONS: [
        {
            ACTIONS: [ READ ],
            RESOURCES: [ Logs.system ],
            CONDITIONS: level IN [ "ERROR", "WARN" ]
        }
    ]
}

GROUP Maintainers {
    MEMBERS: [ A, B, C ],
    ROLE: [ Ops ]
}



ROLE PaymentOps {
    PERMISSIONS: [
        {
            ACTIONS: [ MODIFY ],
            RESOURCES: [ Account ],
            CONDITIONS: (balance - 200) >= 0
        }
    ]
}

ROLE AllRead {
    CAN: [ READ ] RESOURCES: [ Data.* ]
}

USER Root {
    ROLE: [ SuperUser ]
}



ROLE Logger {
    PERMISSIONS: [
        {
            ACTIONS: [ WRITE ],
            RESOURCES: [ Logs.app ]
        }
    ]
}

GROUP Mixed {
    MEMBERS: [ X, Y ],
    ROLE: [ A, B ]
}

ROLE Check {
    PERMISSIONS: [
        {
            ACTIONS: [ READ ],
            RESOURCES: [ System.check ],
            CONDITIONS: (temp > 100 AND pressure < 50)
        }
    ]
}


ROLE APIUser {
    PERMISSIONS: [
        {
            ACTIONS: [ EXECUTE ],
            RESOURCES: [ ApiResource.v1.users ],
            CONDITIONS: token.expiry > now
        }
    ]
}








ROLE admin {
    PERMISSIONS: [
        {
            ACTIONS: [READ, WRITE, DELETE],
            RESOURCES: [db_finance.*, server_main],
            CONDITIONS: (name == "Alice" or time < "18:00")
        }
    ]
}


ROLE manager EXTENDS admin {
    CAN: [MODIFY, START]
    RESOURCES: [server_main]
}

ROLE auditor {
    CAN: [READ, EXECUTE, *]
    RESOURCES: [db_finance.*, server_main]
}

// ---- Users ----
USER Alice {
    ROLE: [admin],
    VALID_FROM: "2025-01-01",
    VALID_UNTIL: "2025-12-31"
}

USER Bob {
    ROLE: [manager]
}


// ---- Groups ----
GROUP DevTeam {
    MEMBERS: [Alice, Bob, Charlie],
    ROLE: [manager]
}


ROLE Admin {
    PERMISSIONS: [
        {
            ACTIONS: [ READ ],
            RESOURCES: [ File ]
        }
    ]
}

USER Bob {
}



GROUP TeamA {
}

ROLE Editor EXTENDS Writer {
    CAN: [ WRITE, READ ] RESOURCES: [ Document ]
}

USER Jordan {
    ROLE: [ Admin ]
}


GROUP DevTeam {
    MEMBERS: [ Alice, Bob ]
}